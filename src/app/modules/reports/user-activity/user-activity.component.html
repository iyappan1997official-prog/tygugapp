<div class="card py-4 cardheight scroll noFilterContentScroller" id="comp" [formGroup]="activityDetailForm">
    <div fxLayout="row" fxLayout.lt-md="column" fxLayoutAlign="space-between center">
        <div fxFlex="50%" fxLayoutAlign.lt-md="start center">
            <h2 class="mb-0 main-color font-w-600 fs-24">
                <img class="cursor mb-1 doNotPrint" src="../../../../assets/logos/arrow-backP.svg"
                    routerLink="/reports">
                User Activity Report
            </h2>
        </div>
    </div>
    <div fxLayout="row" fxLayout.lt-md="column" fxLayoutAlign="space-between center" class="mt-4">
        <div fxLayout="row" fxLayoutGap="10px" fxLayout.lt-md="column" fxLayoutAlign="space-between center">
            <mat-form-field appearance="outline" class="input-pdt fs-16 searchBox">
                <mat-icon matPrefix class="sub-prefix">search</mat-icon>
                <input matInput placeholder="User Name" trim formControlName="searchBy">
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width input-pdt searchBox dataSearch fs-16">
                <input matInput placeholder="Start Date" formControlName="startDate" [matDatepicker]="picker">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width input-pdt searchBox dataSearch fs-16">
                <input matInput placeholder="End Date" formControlName="endDate" [matDatepicker]="picker1">
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
        </div>
        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="20px" class="border-left ps-3">
            <button class="btn btn-newPrimary btncolor p-12 mb-xl-0 mb-3"
                (click)="searchFilter=true;searchAppliedFlters()">Search</button>

            <button class="btn btnborder p-12 mb-xl-0 mb-3" (click)="searchFilter=false;resetFilters();"
                [disabled]="searchFilter===false">Reset</button>

        </div>
    </div>
    <div class="table-responsive pt-3">
        <table class="table">
            <thead>
                <tr class="tablelight text-center">
                    <th width="15%">
                        User Name
                    </th>
                    <th width="15%">Role</th>
                    <th width="15%">Recent Login Date</th>
                    <th width="10%">Last Login Mode</th>
                    <th width="12%">Duration</th>
                    <th width="10%">No. of Login</th>
                    <th width="17%">Last Activity</th>
                </tr>
            </thead>
            <tbody>
                <ng-container *ngIf="items$ | async as userData;">
                    <ng-container *ngIf="userData && userData.length > 0; else noData">

                        <tr class="text-center" *ngFor="let data of userData;let i = index">
                            <td class="cursor-pointer"
                                (click)="[this.roleEnum.masterAdmin].includes(loggedInUserRole) ? profileModal(data['userId']) : ''">
                                {{data['name']}}
                            </td>
                            <td>
                                {{data['role']}}
                            </td>
                            <td>
                                {{data['logInTime'] ? (data['logInTime'] | date:
                                'MM/dd/yyyy') : '--'}}
                            </td>
                            <td>{{data['loginSource']}}</td>
                            <td>{{data['totalActivityTime'] | number : '.1-2'}} mins</td>
                            <td>{{data['numberOfLogins']}}</td>
                            <td>
                                <div class="tool pe-2" *ngIf="data['isShipped'] || data['isReceived']">
                                    <i class="fa-solid fa-circle-info"></i>
                                    <span class="tooltiptext">
                                        <div class="scroller">
                                            <ng-container *ngFor="let item of data['loginActivities']">
                                                <p *ngIf="item['shippedCount']">Shipped {{item['shippedCount']}} quilts
                                                    <span *ngIf="item['orderNumber']">for Order No.
                                                        {{item['orderNumber']}}
                                                    </span>
                                                </p>
                                                <p *ngIf="item['receivedCount']">Received {{item['receivedCount']}}
                                                    quilts
                                                    <span *ngIf="item['orderNumber']">for Order No.
                                                        {{item['orderNumber']}}
                                                    </span>
                                                </p>
                                            </ng-container>
                                        </div>
                                    </span>
                                </div>
                                {{data['isReceived'] && data['isShipped'] ? 'Received & Shipped' : data['isReceived'] ?
                                'Received' : data['isShipped'] ? 'Shipped' : '--' }}

                            </td>
                        </tr>
                    </ng-container>
                    <ng-template #noData>
                        <tr>
                            <td colspan="7" class="bg-white">
                                <div class="text-center">
                                    <h3>The user has not logged-in in the given date range</h3>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                </ng-container>
            </tbody>
        </table>
    </div>
    <div fxLayout="row" fxLayoutAlign="space-between center" class="mt-4">
        <div class="fs-14 text-secondary">*This report contains login details of users in last 7 days.</div>
        <mat-paginator [length]="length" [pageIndex]="activityDetailForm?.getRawValue()?.pageNumber - 1"
            [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" (page)="paginator($event)" showFirstLastButtons
            aria-label="Select page">
        </mat-paginator>
    </div>
</div>